@section Header
{
    <title>@LocaleResources.Core.Views.Reference.Index.Page </title>

    <script type="text/html" id="headings">
        <tr>
            <th class="col-2 order-0" scope="col">
                <span class="d-flex align-content-start" title="@LocaleResources.Core.Contents.Reference.Name">@LocaleResources.Core.Contents.Reference.Name</span>
            </th>
            <th class="col-4 order-1" scope="col">
                <span class="d-flex align-content-start" title="@LocaleResources.Core.Contents.Reference.Description">@LocaleResources.Core.Contents.Reference.Description</span>
            </th>
            <th class="col-2 order-2" scope="col">
                <span class="d-flex align-content-start" title="@LocaleResources.Core.Contents.Reference.ContentFile">@LocaleResources.Core.Contents.Reference.ContentFile</span>
            </th>
            <th class="col-2 order-3" scope="col"></th>
            <th class="col-2 order-4" scope="col">&nbsp;</th>
        </tr>
    </script>

    <script type="text/html" id="rows">
        <tr>
            <td><span class="d-flex align-content-start" data-bind="text: Name()"></span></td>
            <td><span class="d-flex align-content-start" data-bind="text: Description()"></span></td>
            <td><span class="d-flex align-content-start" data-bind="text: ContentFile()"></span></td>
            <td><p class="paragraph-normal-text d-flex align-content-start">@LocaleResources.Core.Contents.Reference.Readable <input data-bind="checked: Readable(), disable: true" type="checkbox" /> @LocaleResources.Core.Contents.Reference.Picture <input data-bind="checked: Picture(), disable: true" type="checkbox" /> @LocaleResources.Core.Contents.Reference.AudioVideo <input data-bind="checked: AudioVideo(), disable: true" type="checkbox" /> @LocaleResources.Core.Contents.Reference.Download <input data-bind="checked: Download(), disable: true" type="checkbox" /></p></td>
            <td>
                <div class="hidden-phone visible-desktop action-buttons d-flex align-content-start">
                    <a class="green" href="#" data-bind="attr: { href: DownloadLink() }" title="@SharedLibrary.Core.Resources.Global.FormMessages.DownloadD"><i class="fa fa-edit text-success"></i>@SharedLibrary.Core.Resources.Global.FormMessages.Download</a>
                    <a class="green" href="#" data-bind="click: function(data, event) { $parent.resetFormForEditing($index); $('#__form').dialog('open'); }" title="@SharedLibrary.Core.Resources.Global.FormMessages.EditD"><i class="fa fa-edit text-success"></i>@SharedLibrary.Core.Resources.Global.FormMessages.Edit</a>
                    <a class="red" href="#" data-bind="click: function(data, event) { $parent.delete($data); }" title="@SharedLibrary.Core.Resources.Global.FormMessages.DeleteD"><i class="fa fa-times text-danger"></i>@SharedLibrary.Core.Resources.Global.FormMessages.Delete</a>
                </div>
            </td>
        </tr>
</script>

    <script type="text/html" id="formcontent">
        <form id="__uploadform">
            <div class="form-group row">
                <div class="col-12">
                    <label class="control-label d-flex align-content-start" for="Name">
                        @LocaleResources.Core.Contents.Reference.Name
                    </label>
                    <input class="form-control col-12" data-bind="value: $root.EditMode() ? Name : Name" id="Name" name="Name" type="text" title="@LocaleResources.Core.Contents.Reference.Name"
                           maxlength="100" placeholder="" /><span class="error"
                                                                                       data-bind="validationMessage: Name"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-12">
                    <label class="control-label d-flex align-content-start" for="Description">
                        @LocaleResources.Core.Contents.Reference.Description
                    </label>
                    <textarea data-bind="value: $root.EditMode() ? Description : Description" class="form-control col-12" title="@LocaleResources.Core.Contents.Reference.Description"
                              id="Description" name="Description" maxlength="1024" rows="3" placeholder=""></textarea><span class="error" data-bind="validationMessage: Description"></span>
                </div>
            </div>
            <div class="form-group row">
                <div class="col-12">
                    <label class="control-label d-flex align-content-start" for="upload">
                        @SharedLibrary.Core.Resources.Global.FormMessages.Upload
                    </label>
                    <div class="input-group d-flex align-content-start">
                        <select class="col-2 form-control order-first" id="uploadType" name="uploadType">
                            <option value="readable" selected>readable</option>
                            <option value="image">image</option>
                            <option value="video">video</option>
                        </select>
                        <input class="col-10 form-control form-control-file order-last" id="upload" name="upload" type="file" />
                    </div>
                    <input id="recordid" name="recordid" type="hidden" data-bind="value: $data.getKey()" />
                </div>
            </div>
            <div class="form-group row">
                <div class="col-4 order-0">
                    <label class="control-label d-flex align-content-start" for="">
                        @LocaleResources.Core.Contents.Reference.Download
                    </label>
                    <input class="form-check d-flex align-content-start"  data-bind="checked: $root.EditMode() ? Download : Download" id="Download" name="Download" title="@LocaleResources.Core.Contents.Reference.Download"
                           type="checkbox" /><span class="error" data-bind="validationMessage: Download"></span>
                </div>
            </div>
            <input id="Uid" name="Uid" type="hidden" data-bind="value: Uid" />
            <input id="ReferenceId" name="ReferenceId" type="hidden" value='@ViewData["TransactionID"]' />
            <input id="ContentFile" name="ContentFile" type="hidden" data-bind="value: ContentFile" />
            <input id="Size" name="Size" type="hidden" data-bind="value: ((Size === null || Size === undefined) ? 0 : Size)" />
            <input id="Readable" name="Readable" type="hidden" data-bind="value: Readable" />
            <input id="Picture" name="Picture" type="hidden" data-bind="value: Picture" />
            <input id="AudioVideo" name="AudioVideo" type="hidden" data-bind="value: AudioVideo" />
        </form>
    <div class="clear-fix">
    </div>
</script>
}

<div class="container">
    <h2 class="d-flex align-content-start">@LocaleResources.Core.Views.Reference.Index.Page</h2>
    <p class="d-flex align-content-start">@LocaleResources.Core.Views.Reference.Index.PageD</p>
</div>

@Controls.Core.Grid.GridComposer.composeGrid(null, null, null, null, null, null, null, null, null, null)

<section style="display: none">
    @Controls.Core.Grid.GridComposer.composeStandardActions(null, "#__form", false, null, null, false)

    @Controls.Core.Grid.GridComposer.composeStandardListing(null, "#__form", true)

    @Controls.Core.Form.FormComposer.composeForm("__form", null, null, null, "<div data-bind=\"template: {name: 'formcontent' }\"></div>", null, "create({\"target\": \"CreateContent\"})", "update({\"target\": \"UpdateContent\"})", null, false)
</section>

@section Scripts {
    <script src="~/js/models/Reference.js" type="text/javascript"></script>

    <script type="text/javascript">

        var crudView = new CRUDView({
                'uri': '/admin/reference',
                'objectkey': '@ViewData["TransactionID"]',
                'observer': new CRUDObserver({ 'contentType': new Reference({}), 'messages': intialize(new MessageRepository()) }),
                'progressEvent': true
        });

        crudView.getObserverObject().setListSource(crudView);

        $('#__form').dialog({ autoOpen: false, width: "auto", maxWidth: 1000 });

        $(function () {

            try {

                ko.applyBindings(crudView.getObserverObject());
            } catch (e) {

                console.log(e.message);
            }
            
            crudView.find(1);
        });

    </script>
}

