@inject IOptions<ApplicationSettings> ApplicationSettings

@inject IStringLocalizer<FormMessages> FormMessages
@inject IStringLocalizer<StandardMessages> StandardMessages

@inject IHtmlLocalizer<LocaleResources.Core.Views.Home> ViewMessages
@inject IStringLocalizer<Application.Core.Views.Product.Index> ProductMessages

@{
    ViewBag.Title = "Home Page";
}
@section Header
    {
    <title>@ViewMessages["Page"]</title>

    <script type="text/html" id="list_item_products">
        <li>
            <a href="#" data-bind="click: function(data, event) { $parent.FormProducts(data); $('#__form_product_image').dialog('open'); }">
                <!--  -->
                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title: Name() }" />

            </a>
            <div class="detail">
                <span data-bind="text: BriefName(), attr: { title: Name() } " class="productname"></span>&nbsp;<sup><span data-bind="text: ProductYear()" title='@ProductMessages["ModelYearD"]'></span></sup><br />
                <span data-bind="text: Manufacturer()" title='@ProductMessages["ManufacturerD"]'></span>&nbsp;<span data-bind="text: Category()" title='@ProductMessages["CategoryD"]'></span>&nbsp;<span data-bind="text: Unit()" title='@ProductMessages["UnitD"]'></span>
            </div>
        </li>
    </script>

    <script type="text/html" id="viewimage_product">
        <img class="img-fluid" data-bind="attr: {src: $data.PictureLink() }" style="display:block; margin:auto auto;" alt="" />
    </script>

    <script type="text/html" id="viewimage">
        <img class="img-fluid d-block m-auto" data-bind="attr: { src: $data.PictureLink() }" alt="" />
    </script>

    <script type="text/html" id="viewvideo">
        <p>
            <video src="#" data-bind="attr:{src: $data.VideoLink() }" controls width="500" class="center-content"></video>
        </p>
    </script>

}

@section PagePath{ }

@section ContentHeader
    {
    <div id="maincarousel" class="carousel slide" data-ride="carousel">
        <!-- Indicators -->
        <ol class="carousel-indicators">
            <li data-target="#maincarousel" data-slide-to="0" class="active"></li>
            <li data-target="#maincarousel" data-slide-to="1"></li>
            <li data-target="#maincarousel" data-slide-to="2"></li>
            <li data-target="#maincarousel" data-slide-to="3"></li>
            <li data-target="#maincarousel" data-slide-to="4"></li>
        </ol>
        <div class="carousel-inner" role="listbox">
            <div class="carousel-item active">
                <img class="img-fluid rounded mx-auto d-block" src="@Url.Content("~/images/sliders/slide2.png")" alt=".">
                <div class="container">
                    <div class="carousel-caption d-none d-md-block">
                        <h1>
                            Solutions That Matter
                        </h1>
                        <p></p>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img class="img-fluid rounded mx-auto d-block" src="@Url.Content("~/images/sliders/slide1.png")" alt="Slider Image">
                <div class="container">
                    <div class="carousel-caption d-none d-md-block">
                        <h1>
                            Products That Help
                        </h1>
                        <p>

                        </p>
                    </div>
                </div>
            </div>
            <div class="carousel-item">
                <img class="img-fluid rounded mx-auto d-block" src="@Url.Content("~/images/sliders/slide3.png")" alt="Slider Image">
                <div class="carousel-caption d-none d-md-block">
                    <h1>
                        Services That Inspire
                    </h1>
                    <p>

                    </p>
                </div>
            </div>
            <div class="carousel-item">
                <img class="img-fluid rounded mx-auto d-block" src="@Url.Content("~/images/sliders/slide4.png")" alt="Slider Image">
            </div>
            <div class="carousel-item">
                <img class="img-fluid rounded mx-auto d-block" src="@Url.Content("~/images/sliders/slide5.png")" alt="Slider Image">
            </div>
        </div>
        <a class="carousel-control-prev" href="#maincarousel" role="button" data-slide="prev">
            <span class="fa fa-angle-left text-primary"></span>
            @*<span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>*@
        </a>
        <a class="carousel-control-next" href="#maincarousel" role="button" data-slide="next">
            <span class="fa fa-angle-right text-primary"></span>
            @*<span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>*@
        </a>
    </div>
}

<div id="webpage" class="container-fluid" itemscope itemtype="http://schema.org/WebPage">
    <section class="container">
        <h2 class="d-flex justify-content-lg-start" itemprop="name">
            @ViewMessages["Welcome"]
        </h2>
        <p itemprop="description">
        </p>
    </section>
</div>

<span class="center-content" data-bind="template: {name: 'results_processing'}" style="width: 32px"></span>

<!-- PRODUCTS -->
<section id="products">
    <div class="container">
        <ul data-bind="template: {name: 'list_item_products', foreach: Products}" class="products"></ul>
    </div>
</section>

<section style="display: none">
    @Controls.Core.Form.FormComposer.composeForm("__form_product_image", "data-bind='with: FormProducts()'", null, FormMessages["ImageViewForm"], "<div data-bind=\"template: {name: 'viewimage_product' }\"></div>", "view", null, null, null, false)

    @Controls.Core.Form.FormComposer.composeForm("__form_advertisement_image", null, null, FormMessages["ImageViewForm"], "<div data-bind=\"template: {name: 'viewimage' }\"></div>", "view", null, null, null, false)

    @Controls.Core.Form.FormComposer.composeForm("__form_advertisement_video", null, null, FormMessages["VideoViewForm"], "<div data-bind=\"template: {name: 'viewvideo' }\"></div>", "view", null, null, null, false)
</section>

<!-- ADVERTISEMENTS -->
<section id="advertisements">

    <div class="container recent-works" data-bind="visible: (ContentAds1().length > 0 || ContentAds2().length > 0 || ContentAds3().length > 0)" style="display:none">
        <div class="row">
            <div data-bind="visible: ContentAds1().length > 0" class="col-4">
                <div id="contentad1" class="carousel slide" data-ride="carousel" style="height: 220px;">
                    <div data-bind="foreach: ContentAds1" class="carousel-inner" role="listbox">
                        <!-- ko if: $index() == 0 -->
                        <div class="carousel-item active">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title:Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                        <!-- ko if: $index() > 0 -->
                        <div class="carousel-item">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title:Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                    </div>
                </div>
            </div>
            <div data-bind="visible: ContentAds2().length > 0" class="col-4" style="height: 220px;">
                <div id="contentad2" class="carousel slide" data-ride="carousel">
                    <div data-bind="foreach: ContentAds2" class="carousel-inner" role="listbox">
                        <!-- ko if: $index() == 0 -->
                        <div class="carousel-item active">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title: Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                        <!-- ko if: $index() > 0 -->
                        <div class="carousel-item">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title:Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                    </div>
                </div>
            </div>
            <div data-bind="visible: ContentAds3().length > 0" class="col-4" style="height: 220px;">
                <div id="contentad3" class="carousel slide" data-ride="carousel">
                    <div data-bind="foreach: ContentAds3" class="carousel-inner" role="listbox">
                        <!-- ko if: $index() == 0 -->
                        <div class="carousel-item active">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title:Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                        <!-- ko if: $index() > 0 -->
                        <div class="carousel-item">
                            <a href="#" class="btn btn-lg" data-bind="attr: { href: Link1() }" target="_blank">
                                <img class="img-fluid img-rounded" data-bind="attr: { src: PictureLink(), title:Heading()  }"
                                     src="#" style="margin: 0px auto" />
                            </a>
                        </div>
                        <!-- /ko -->
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- NEWS ADVERTISEMENTS -->
<section id="news">

    <div class="container">
        <h2 class="d-flex justify-content-start">
            @ViewMessages["NewsTitle"]
        </h2>
        <div class="row">
            <div class="col-4 d-flex justify-content-start">
                <!-- ko if: LatestNews != null -->
                <div class="news-item">
                    <div data-bind="with: LatestNews" class="latest">
                        <a href="#" data-bind="click: function (data, event) { $parent.setFormObject(data); $('#__form_advertisement_image').dialog('open'); }, attr: { title: Heading() }">
                            <img data-bind="attr: { src: PictureLink(), title:Heading()  }" class="img-fluid img-rounded" title="latest news">
                        </a>
                        <h4 class="subject">
                            <a data-bind="attr: {href: 'news/' + UID }" href="#" target="_blank"><span data-bind="text: BriefHeading()"></span></a>
                        </h4>
                        <p class="detail" data-bind="text: LatestDetail()"></p>
                        <div class="">
                            <span data-bind="text: moment(moment.utc(UpdateTime).toDate()).format('YYYY-MM-DD HH:mm:ss')" class="news-datetime"></span>
                        </div>
                    </div>
                </div>
                <!-- /ko -->
                <span data-bind="visible: LatestNews() == null" style="display:none">
                    No News Found.
                </span>
            </div>
            <div data-bind="visible: NewsList().length > 0" class="col-8  d-flex justify-content-end">
                <div class="row" data-bind="foreach: NewsList">
                    <div class="news-item col-6">
                        <h5 class="subject">
                            <a data-bind="attr: {href: 'news/' + UID }" href="#">
                                <span data-bind="text: BriefHeading() "></span>
                            </a>
                        </h5>
                        <p class="normal">
                            <a href="#" data-bind="click: function(data, event) { $parent.setFormObject(data); $('#__form_advertisement_image').dialog('open'); }, attr: { title: Heading() }">
                                <img data-bind="attr: { src: PictureLink(), title: Heading() }" class="img-fluid img-rounded float-left news-item-image">
                            </a>
                            <span class="detail" data-bind="text: BriefDetail()"></span>
                        </p>
                    </div>
                    <div data-bind="visible: ($index() === ($parents[0].NewsList().length - 1))" class="news-item col-6">
                        <h4>
                            <a href="@Url.Action("index","news")"> @ViewMessages["AllNews"] <i class="fa fa-newspaper-o"></i></a>
                        </h4>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- CALL-TO-ACTION -->
<section class="call-to-action">
    <div class="container">
        <h2 class="section-heading d-flex justify-content-start">
            @ViewMessages["Contact"]
        </h2>
        <div class="d-flex justify-content-end align-middle">
            <span>@ApplicationSettings.Value.ContactPhone</span>
        </div>
    </div>
</section>
<!-- END CALL-TO-ACTION -->

@section Scripts
    {
    <script src="~/js/models/Advertisement.js" type="text/javascript"></script>
    <script src="~/js/models/Product.js" type="text/javascript"></script>

    <script type="text/javascript">

        var compositeFieldsView = new CRUDView({
            'observer': new CRUDObserver({ 'contentType': new Advertisement({}), 'messages': intialize(new MessageRepository()) }),
            'fields': [
                {
                    'uri': '/product',
                    'target': 'getrandom',
                    'contentType': new Product({}),
                    'field': 'Products',
                    'formObject': 'FormProducts'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestnewssingle',
                    'contentType': new Advertisement({}),
                    'field': 'LatestNews',
                    'expectObjectResult': true
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestnews',
                    'contentType': new Advertisement({}),
                    'field': 'NewsList'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestby',
                    'query': { 'keywords': [{ 'Field': 'Page', 'Value': 'all' }, { 'Field': 'Location', 'Value': 'header' }], 'total': 5 },
                    'contentType': new Advertisement({}),
                    'field': 'HeaderAds'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestby',
                    'query': { 'keywords': [{ 'Field': 'Page', 'Value': 'all' }, { 'Field': 'Location', 'Value': 'footer' }], 'total': 5 },
                    'contentType': new Advertisement({}),
                    'field': 'FooterAds'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestby',
                    'query': { 'keywords': [{ 'Field': 'Page', 'Value': 'all' }, { 'Field': 'Location', 'Value': 'content-1' }], 'total': 5 },
                    'contentType': new Advertisement({}),
                    'field': 'ContentAds1'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestby',
                    'query': { 'keywords': [{ 'Field': 'Page', 'Value': 'all' }, { 'Field': 'Location', 'Value': 'content-2' }], 'total': 5 },
                    'contentType': new Advertisement({}),
                    'field': 'ContentAds2'
                },
                {
                    'uri': '/advertisement',
                    'target': 'getlatestby',
                    'query': { 'keywords': [{ 'Field': 'Page', 'Value': 'all' }, { 'Field': 'Location', 'Value': 'content-3' }], 'total': 5 },
                    'contentType': new Advertisement({}),
                    'field': 'ContentAds3'
                }
            ]
        });

        $(function () {

            compositeFieldsView.ExtendFields();

            try {

                ko.applyBindings(compositeFieldsView.getObserverObject());

            } catch (e) {

                console.log(e.message);
                compositeFieldsView.getObserverObject().displayFailureActivity();
            }

            compositeFieldsView.LoadFields();

            $('#__form_product_image').dialog({ autoOpen: false, width: 600 });
            $('#__form_advertisement_image').dialog({ autoOpen: false, width: 600 });
            $('#__form_advertisement_video').dialog({ autoOpen: false, width: 600 });
        });

    </script>
}